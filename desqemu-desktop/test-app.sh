#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è DESQEMU Desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DESQEMU Desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
echo "=========================================="

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f "neu run" 2>/dev/null || true
sleep 2

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
echo "üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª—ã..."
if [ ! -f "resources/index.html" ]; then
    echo "‚ùå resources/index.html –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

if [ ! -f "resources/js/app.js" ]; then
    echo "‚ùå resources/js/app.js –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

if [ ! -f "resources/icons/appIcon.png" ]; then
    echo "‚ùå resources/icons/appIcon.png –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

if [ ! -f "resources/js/novnc/utils/novnc_proxy" ]; then
    echo "‚ùå noVNC –ø—Ä–æ–∫—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    exit 1
fi

echo "‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º QEMU
echo "üîß –ü—Ä–æ–≤–µ—Ä—è–µ–º QEMU..."
if command -v qemu-system-x86_64 >/dev/null 2>&1; then
    echo "‚úÖ QEMU –Ω–∞–π–¥–µ–Ω"
else
    echo "‚ùå QEMU –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "üí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ QEMU: brew install qemu"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º QCOW2 –æ–±—Ä–∞–∑
echo "üì¶ –ü—Ä–æ–≤–µ—Ä—è–µ–º QCOW2 –æ–±—Ä–∞–∑..."
if [ -f "resources/qcow2/alpine-bootable.qcow2" ]; then
    echo "‚úÖ QCOW2 –æ–±—Ä–∞–∑ –Ω–∞–π–¥–µ–Ω"
else
    echo "‚ùå QCOW2 –æ–±—Ä–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "üí° –°–æ–∑–¥–∞–π—Ç–µ –æ–±—Ä–∞–∑: ./install-alpine-to-qcow2.sh"
fi

echo ""
echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..."
echo "=========================="
echo ""
echo "üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:"
echo "1. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ"
echo "2. –ù–∞–∂–º–∏—Ç–µ '–ó–∞–ø—É—Å—Ç–∏—Ç—å VM' –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã"
echo "3. –ù–∞–∂–º–∏—Ç–µ '–ü–æ–∫–∞–∑–∞—Ç—å –¥–∏—Å–ø–ª–µ–π VM' –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è VNC"
echo ""
echo "üõë –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: Ctrl+C"

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
neu run 
